<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-------------------------------------------------------------->
<!-- qLibc Project                                            -->
<!--                                                          -->
<!--            Copyright (c) The qDecoder Project            -->
<!--                 http://www.qdecoder.org                  -->
<!-------------------------------------------------------------->

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <title>qlibcext: extensions/qhttpclient.c File Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>

<body>
<center><h1>qLibc API Reference</h1></center>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>extensions/qhttpclient.c File Reference</h1>  </div>
</div>
<div class="contents">
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>HTTP client object. </p>
<p>qhttpclient implements HTTP client.</p>
<p>Example code for simple HTTP GET operation.</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">  #define REMOTE_URL  &quot;/robots.txt&quot;</span>
<span class="preprocessor"></span><span class="preprocessor">  #define SAVEFILE    &quot;/tmp/robots.txt&quot;</span>
<span class="preprocessor"></span>
  <span class="keywordtype">int</span> main(<span class="keywordtype">void</span>) {
    <span class="comment">// create new HTTP client</span>
    qhttpclient_t *httpclient = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;https://secure.qdecoder.org&quot;</span>, 0);
    <span class="keywordflow">if</span>(httpclient == NULL) <span class="keywordflow">return</span> -1;

    <span class="comment">// open file for writing</span>
    <span class="keywordtype">int</span> nFd = open(SAVEFILE, O_CREAT | O_TRUNC | O_WRONLY, 0644);
    <span class="keywordflow">if</span>(nFd &lt; 0) {
      httpclient-&gt;free(httpclient);
      <span class="keywordflow">return</span> -1;
    }

    <span class="comment">// container for storing response headers for debugging purpose</span>
    qlisttbl_t *resheaders = qlisttbl();

    <span class="comment">// download</span>
    off_t nSavesize = 0;
    <span class="keywordtype">int</span> nRescode = 0;
    <span class="keywordtype">bool</span> bRet = httpclient-&gt;get(httpclient, REMOTE_URL, nFd, &amp;nSavesize,
                                &amp;nRescode, NULL, resheaders, NULL, NULL);

    <span class="comment">// close file</span>
    close(nFd);

    <span class="comment">// print out debugging info</span>
    printf(<span class="stringliteral">&quot;%s %d, %d bytes saved\n&quot;</span>, (bRet?<span class="stringliteral">&quot;Success&quot;</span>:<span class="stringliteral">&quot;Failed&quot;</span>), nRescode,
                                       (<span class="keywordtype">int</span>)nSavesize);
    resheaders-&gt;debug(resheaders, stdout);

    <span class="comment">// de-allocate HTTP client object</span>
    httpclient-&gt;free(httpclient);

    <span class="keywordflow">return</span> (bRet ? 0 : -1);
  }

  [Output]
  Success 200, 30 bytes saved
  Date=Fri, 11 Feb 2011 23:40:50 GMT? (30)
  Server=Apache? (7)
  Last-Modified=Sun, 15 Mar 2009 11:43:07 GMT? (30)
  ETag=&quot;2e5c9d-1e-46526d665c8c0&quot;? (26)
  Accept-Ranges=bytes? (6)
  Content-Length=30? (3)
  Cache-Control=max-age=604800? (15)
  Expires=Fri, 18 Feb 2011 23:40:50 GMT? (30)
  Connection=close? (6)
  Content-Type=text/plain? (11)
</pre></div><p>Example code for multiple PUT operation using same keep-alive connection.</p>
<div class="fragment"><pre class="fragment">  <span class="comment">// create new HTTP client</span>
  qhttpclient_t *httpclient = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;www.qdecoder.org&quot;</span>, 80);
  <span class="keywordflow">if</span>(httpclient == NULL) <span class="keywordflow">return</span>;

  <span class="comment">// set options</span>
  httpclient-&gt;setkeepalive(httpclient, <span class="keyword">true</span>);

  <span class="comment">// make a connection</span>
  <span class="keywordflow">if</span>(httpclient-&gt;open(httpclient) == <span class="keyword">false</span>) <span class="keywordflow">return</span>;

  <span class="comment">// upload files</span>
  httpclient-&gt;put(httpclient, ...);
  httpclient-&gt;put(httpclient, ...); <span class="comment">// will be done within same connection.</span>

  <span class="comment">// close connection - not necessary if we call free() just after this.</span>
  httpclient-&gt;close(httpclient);

  <span class="comment">// de-allocate HTTP client object</span>
  httpclient-&gt;free(httpclient);
</pre></div> <table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad02ab7af04409020264521a798de2a5a"></a><!-- doxytag: member="qhttpclient.c::HTTP_NO_RESPONSE" ref="ad02ab7af04409020264521a798de2a5a" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_NO_RESPONSE</b>&nbsp;&nbsp;&nbsp;(0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad1f324698e12fefadfc2ec5d16ce6a5b"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_CONTINUE" ref="ad1f324698e12fefadfc2ec5d16ce6a5b" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_CONTINUE</b>&nbsp;&nbsp;&nbsp;(100)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a471de168f41ecf5e8d62a43fea28b5d7"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_OK" ref="a471de168f41ecf5e8d62a43fea28b5d7" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_OK</b>&nbsp;&nbsp;&nbsp;(200)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a00c11c6c6bf42cf1fb483c273454cf45"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_CREATED" ref="a00c11c6c6bf42cf1fb483c273454cf45" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_CREATED</b>&nbsp;&nbsp;&nbsp;(201)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7e41c8a47383e2bdf4b34ce5510bc9b6"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_NO_CONTENT" ref="a7e41c8a47383e2bdf4b34ce5510bc9b6" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_NO_CONTENT</b>&nbsp;&nbsp;&nbsp;(204)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a463a0b7aed650158725b205bc1bd0de8"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_MULTI_STATUS" ref="a463a0b7aed650158725b205bc1bd0de8" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_MULTI_STATUS</b>&nbsp;&nbsp;&nbsp;(207)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a33f32423ccbf3a2a61f56cc5aee18cd8"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_MOVED_TEMPORARILY" ref="a33f32423ccbf3a2a61f56cc5aee18cd8" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_MOVED_TEMPORARILY</b>&nbsp;&nbsp;&nbsp;(302)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a225a5999b63c699c4492a8412b315452"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_NOT_MODIFIED" ref="a225a5999b63c699c4492a8412b315452" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_NOT_MODIFIED</b>&nbsp;&nbsp;&nbsp;(304)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16c7e21f17349c2515fe0134f9b7ffd4"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_BAD_REQUEST" ref="a16c7e21f17349c2515fe0134f9b7ffd4" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_BAD_REQUEST</b>&nbsp;&nbsp;&nbsp;(400)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac68e0a1d868dad52967d757dab5220db"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_FORBIDDEN" ref="ac68e0a1d868dad52967d757dab5220db" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_FORBIDDEN</b>&nbsp;&nbsp;&nbsp;(403)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20eb5cc8af538c827de0f7ed9811243c"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_NOT_FOUND" ref="a20eb5cc8af538c827de0f7ed9811243c" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_NOT_FOUND</b>&nbsp;&nbsp;&nbsp;(404)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c8d72a7d4eda32ad9a6211958463e97"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_METHOD_NOT_ALLOWED" ref="a7c8d72a7d4eda32ad9a6211958463e97" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_METHOD_NOT_ALLOWED</b>&nbsp;&nbsp;&nbsp;(405)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a78c49465c70c576daa60e34a84a9e47c"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_REQUEST_TIME_OUT" ref="a78c49465c70c576daa60e34a84a9e47c" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_REQUEST_TIME_OUT</b>&nbsp;&nbsp;&nbsp;(408)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0023f7e49348c8c52b2fb8b547202ed3"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_REQUEST_URI_TOO_LONG" ref="a0023f7e49348c8c52b2fb8b547202ed3" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_REQUEST_URI_TOO_LONG</b>&nbsp;&nbsp;&nbsp;(414)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6d47746cc8b934944ed4f05308b2da63"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_INTERNAL_SERVER_ERROR" ref="a6d47746cc8b934944ed4f05308b2da63" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_INTERNAL_SERVER_ERROR</b>&nbsp;&nbsp;&nbsp;(500)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e272d1190eb37ce4447a9021f68a0c4"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_NOT_IMPLEMENTED" ref="a9e272d1190eb37ce4447a9021f68a0c4" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_NOT_IMPLEMENTED</b>&nbsp;&nbsp;&nbsp;(501)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a00a05677bf92a38abf5be28b5ce0d294"></a><!-- doxytag: member="qhttpclient.c::HTTP_CODE_SERVICE_UNAVAILABLE" ref="a00a05677bf92a38abf5be28b5ce0d294" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_CODE_SERVICE_UNAVAILABLE</b>&nbsp;&nbsp;&nbsp;(503)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba396af03e2875b5ddedee43ad3c4707"></a><!-- doxytag: member="qhttpclient.c::HTTP_PROTOCOL_11" ref="aba396af03e2875b5ddedee43ad3c4707" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>HTTP_PROTOCOL_11</b>&nbsp;&nbsp;&nbsp;&quot;HTTP/1.1&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a337b3f9b61cacbcde92a255249e4aae5"></a><!-- doxytag: member="qhttpclient.c::SET_TCP_LINGER_TIMEOUT" ref="a337b3f9b61cacbcde92a255249e4aae5" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>SET_TCP_LINGER_TIMEOUT</b>&nbsp;&nbsp;&nbsp;(15)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8c266040b26660f0c96255cadd8ee087"></a><!-- doxytag: member="qhttpclient.c::SET_TCP_NODELAY" ref="a8c266040b26660f0c96255cadd8ee087" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>SET_TCP_NODELAY</b>&nbsp;&nbsp;&nbsp;(1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a34f24b8ca491cffac52bdd24140cd923"></a><!-- doxytag: member="qhttpclient.c::MAX_SHUTDOWN_WAIT" ref="a34f24b8ca491cffac52bdd24140cd923" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>MAX_SHUTDOWN_WAIT</b>&nbsp;&nbsp;&nbsp;(100)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93983c38a271da5bde55becc02135bdb"></a><!-- doxytag: member="qhttpclient.c::MAX_ATOMIC_DATA_SIZE" ref="a93983c38a271da5bde55becc02135bdb" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>MAX_ATOMIC_DATA_SIZE</b>&nbsp;&nbsp;&nbsp;(32 * 1024)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qhttpclient_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b">qhttpclient</a> (const char *destname, int port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize &amp; create new HTTP client.  <a href="#acba5e1d5c9b1666945f7b0ca4da0785b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a5c8eb3bb63df37fe248d858715894870">setssl</a> (qhttpclient_t *client)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a5c8eb3bb63df37fe248d858715894870" title="qhttpclient-&gt;setssl(): Sets connection to HTTPS connection">setssl()</a>: Sets connection to HTTPS connection  <a href="#a5c8eb3bb63df37fe248d858715894870"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a12e0c5c0a30dafae0ece655d6095a75c">settimeout</a> (qhttpclient_t *client, int timeoutms)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a12e0c5c0a30dafae0ece655d6095a75c" title="qhttpclient-&gt;settimeout(): Sets connection wait timeout.">settimeout()</a>: Sets connection wait timeout.  <a href="#a12e0c5c0a30dafae0ece655d6095a75c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a7ee9c5a86a3f561a5dcfe201ff20c350">setkeepalive</a> (qhttpclient_t *client, bool keepalive)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a7ee9c5a86a3f561a5dcfe201ff20c350" title="qhttpclient-&gt;setkeepalive(): Sets KEEP-ALIVE feature on/off.">setkeepalive()</a>: Sets KEEP-ALIVE feature on/off.  <a href="#a7ee9c5a86a3f561a5dcfe201ff20c350"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#af6bffb8f3d215b7225da20a6832bf440">setuseragent</a> (qhttpclient_t *client, const char *useragent)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#af6bffb8f3d215b7225da20a6832bf440" title="qhttpclient-&gt;setuseragent(): Sets user-agent string.">setuseragent()</a>: Sets user-agent string.  <a href="#af6bffb8f3d215b7225da20a6832bf440"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#aaab09f1f3ab6486633b0ea1c0fd65cd2">open_</a> (qhttpclient_t *client)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;open(): Opens a connection to the remote host.  <a href="#aaab09f1f3ab6486633b0ea1c0fd65cd2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#ac3c34055be115314ffe7f18c3d19eb54">head</a> (qhttpclient_t *client, const char *uri, int *rescode, qlisttbl_t *reqheaders, qlisttbl_t *resheaders)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#ac3c34055be115314ffe7f18c3d19eb54" title="qhttpclient-&gt;head(): Sends a HEAD request.">head()</a>: Sends a HEAD request.  <a href="#ac3c34055be115314ffe7f18c3d19eb54"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#af16a3eb0912e8b5d4896466632d9c843">get</a> (qhttpclient_t *client, const char *uri, int fd, off_t *savesize, int *rescode, qlisttbl_t *reqheaders, qlisttbl_t *resheaders, bool(*callback)(void *userdata, off_t recvbytes), void *userdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#af16a3eb0912e8b5d4896466632d9c843" title="qhttpclient-&gt;get(): Downloads a file from the remote host using GET method.">get()</a>: Downloads a file from the remote host using GET method.  <a href="#af16a3eb0912e8b5d4896466632d9c843"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#ae9ac3bd43c11509c0cbd8fb284bf13eb">put</a> (qhttpclient_t *client, const char *uri, int fd, off_t length, int *rescode, qlisttbl_t *reqheaders, qlisttbl_t *resheaders, bool(*callback)(void *userdata, off_t sentbytes), void *userdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#ae9ac3bd43c11509c0cbd8fb284bf13eb" title="qhttpclient-&gt;put(): Uploads a file to the remote host using PUT method.">put()</a>: Uploads a file to the remote host using PUT method.  <a href="#ae9ac3bd43c11509c0cbd8fb284bf13eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#af152fd3b6a32a801dc70a03119b13154">cmd</a> (qhttpclient_t *client, const char *method, const char *uri, void *data, size_t size, int *rescode, size_t *contentslength, qlisttbl_t *reqheaders, qlisttbl_t *resheaders)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#af152fd3b6a32a801dc70a03119b13154" title="qhttpclient-&gt;cmd(): Sends a custom request(method) to the remote host and reads it&#39;s response...">cmd()</a>: Sends a custom request(method) to the remote host and reads it's response.  <a href="#af152fd3b6a32a801dc70a03119b13154"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a1d31e08f7bc114b63cd3140f5f8dc259">sendrequest</a> (qhttpclient_t *client, const char *method, const char *uri, qlisttbl_t *reqheaders)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a1d31e08f7bc114b63cd3140f5f8dc259" title="qhttpclient-&gt;sendrequest(): Sends a HTTP request to the remote host.">sendrequest()</a>: Sends a HTTP request to the remote host.  <a href="#a1d31e08f7bc114b63cd3140f5f8dc259"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a865df9ac070a17d0751e1083af770bb1">readresponse</a> (qhttpclient_t *client, qlisttbl_t *resheaders, off_t *contentlength)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a865df9ac070a17d0751e1083af770bb1" title="qhttpclient-&gt;readresponse(): Reads HTTP response header from the remote host.">readresponse()</a>: Reads HTTP response header from the remote host.  <a href="#a865df9ac070a17d0751e1083af770bb1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static ssize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#ade555b391a0ff83b074eb16a5ba2192f">gets_</a> (qhttpclient_t *client, char *buf, size_t bufsize)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;gets(): Reads a text line from a HTTP/HTTPS stream.  <a href="#ade555b391a0ff83b074eb16a5ba2192f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static ssize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a5dd8f813968295a3cfba53c0acaee487">read_</a> (qhttpclient_t *client, void *buf, size_t nbytes)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;read(): Reads data from a HTTP/HTTPS stream.  <a href="#a5dd8f813968295a3cfba53c0acaee487"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static ssize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a69254acf43767884d060506b96f5c274">write_</a> (qhttpclient_t *client, const void *buf, size_t nbytes)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;write(): Writes data to a HTTP/HTTPS stream.  <a href="#a69254acf43767884d060506b96f5c274"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static off_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a2036374892fed2d1eff6eee25dcbfd9b">recvfile</a> (qhttpclient_t *client, int fd, off_t nbytes)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a2036374892fed2d1eff6eee25dcbfd9b" title="qhttpclient-&gt;recvfile(): Reads data from a HTTP/HTTPS stream and save into a file descriptor...">recvfile()</a>: Reads data from a HTTP/HTTPS stream and save into a file descriptor.  <a href="#a2036374892fed2d1eff6eee25dcbfd9b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static off_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#add20b33d4c87e18756f7023bbc38f22e">sendfile_</a> (qhttpclient_t *client, int fd, off_t nbytes)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;sendfile(): Send file data to a HTTP/HTTPS stream.  <a href="#add20b33d4c87e18756f7023bbc38f22e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a6154b9124c5a57bccfb2dc47c791e555">_close</a> (qhttpclient_t *client)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;close(): Closes the connection.  <a href="#a6154b9124c5a57bccfb2dc47c791e555"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qhttpclient_8c.html#a7a0cda760109d998ee40b94b665ef0ca">_free</a> (qhttpclient_t *client)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">qhttpclient-&gt;free(): Free object.  <a href="#a7a0cda760109d998ee40b94b665ef0ca"></a><br/></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="acba5e1d5c9b1666945f7b0ca4da0785b"></a><!-- doxytag: member="qhttpclient.c::qhttpclient" ref="acba5e1d5c9b1666945f7b0ca4da0785b" args="(const char *destname, int port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qhttpclient_t* qhttpclient </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>destname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>port</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize &amp; create new HTTP client. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>destname</em>&nbsp;</td><td>remote address, one of IP address, FQDN domain name and URI. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>remote port number. (can be 0 when destname is URI)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>HTTP client object if succcessful, otherwise returns NULL.</dd></dl>
<div class="fragment"><pre class="fragment">   qhttpclient_t *client = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;1.2.3.4&quot;</span>, 80);
   qhttpclient_t *client = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;www.qdecoder.org&quot;</span>, 80);
   qhttpclient_t *client = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;http://www.qdecoder.org&quot;</span>, 0);
   qhttpclient_t *client = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;http://www.qdecoder.org:80&quot;</span>, 0);
   qhttpclient_t *client = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;https://www.qdecoder.org&quot;</span>, 0);
   qhttpclient_t *client = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;https://www.qdecoder.org:443&quot;</span>, 0);
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>Keep-alive feature is turned off by default. Turn it on by calling <a class="el" href="qhttpclient_8c.html#a7ee9c5a86a3f561a5dcfe201ff20c350" title="qhttpclient-&gt;setkeepalive(): Sets KEEP-ALIVE feature on/off.">setkeepalive()</a>. If destname is URI string starting with "https://", <a class="el" href="qhttpclient_8c.html#a5c8eb3bb63df37fe248d858715894870" title="qhttpclient-&gt;setssl(): Sets connection to HTTPS connection">setssl()</a> will be called internally. </dd></dl>

</div>
</div>
<a class="anchor" id="a5c8eb3bb63df37fe248d858715894870"></a><!-- doxytag: member="qhttpclient.c::setssl" ref="a5c8eb3bb63df37fe248d858715894870" args="(qhttpclient_t *client)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool setssl </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a5c8eb3bb63df37fe248d858715894870" title="qhttpclient-&gt;setssl(): Sets connection to HTTPS connection">setssl()</a>: Sets connection to HTTPS connection </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><pre class="fragment">   httpclient-&gt;setssl(httpclient);
</pre></div> 
</div>
</div>
<a class="anchor" id="a12e0c5c0a30dafae0ece655d6095a75c"></a><!-- doxytag: member="qhttpclient.c::settimeout" ref="a12e0c5c0a30dafae0ece655d6095a75c" args="(qhttpclient_t *client, int timeoutms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void settimeout </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeoutms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a12e0c5c0a30dafae0ece655d6095a75c" title="qhttpclient-&gt;settimeout(): Sets connection wait timeout.">settimeout()</a>: Sets connection wait timeout. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeoutms</em>&nbsp;</td><td>timeout mili-seconds. 0 for system defaults</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><pre class="fragment">   httpclient-&gt;settimeout(httpclient, 0);    <span class="comment">// default</span>
   httpclient-&gt;settimeout(httpclient, 5000); <span class="comment">// 5 seconds</span>
</pre></div> 
</div>
</div>
<a class="anchor" id="a7ee9c5a86a3f561a5dcfe201ff20c350"></a><!-- doxytag: member="qhttpclient.c::setkeepalive" ref="a7ee9c5a86a3f561a5dcfe201ff20c350" args="(qhttpclient_t *client, bool keepalive)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void setkeepalive </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>keepalive</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a7ee9c5a86a3f561a5dcfe201ff20c350" title="qhttpclient-&gt;setkeepalive(): Sets KEEP-ALIVE feature on/off.">setkeepalive()</a>: Sets KEEP-ALIVE feature on/off. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>keepalive</em>&nbsp;</td><td>true to set keep-alive on, false to set keep-alive off</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><pre class="fragment">   httpclient-&gt;setkeepalive(httpclient, <span class="keyword">true</span>);  <span class="comment">// keep-alive on</span>
   httpclient-&gt;setkeepalive(httpclient, <span class="keyword">false</span>); <span class="comment">// keep-alive off</span>
</pre></div> 
</div>
</div>
<a class="anchor" id="af6bffb8f3d215b7225da20a6832bf440"></a><!-- doxytag: member="qhttpclient.c::setuseragent" ref="af6bffb8f3d215b7225da20a6832bf440" args="(qhttpclient_t *client, const char *useragent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void setuseragent </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>useragent</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#af6bffb8f3d215b7225da20a6832bf440" title="qhttpclient-&gt;setuseragent(): Sets user-agent string.">setuseragent()</a>: Sets user-agent string. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>useragent</em>&nbsp;</td><td>user-agent string</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><pre class="fragment">   httpclient-&gt;setuseragent(httpclient, <span class="stringliteral">&quot;MyAgent/1.0&quot;</span>);
</pre></div> 
</div>
</div>
<a class="anchor" id="aaab09f1f3ab6486633b0ea1c0fd65cd2"></a><!-- doxytag: member="qhttpclient.c::open_" ref="aaab09f1f3ab6486633b0ea1c0fd65cd2" args="(qhttpclient_t *client)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool open_ </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;open(): Opens a connection to the remote host. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if successful, otherwise returns false</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Don't need to open a connection unless you definitely need to do this, because qhttpclient open a connection automatically when it's needed. This function also can be used to veryfy a connection failure with remote host.</dd></dl>
<div class="fragment"><pre class="fragment">   <span class="keywordflow">if</span>(httpclient-&gt;open(httpclient) == <span class="keyword">false</span>) <span class="keywordflow">return</span>;
</pre></div> 
</div>
</div>
<a class="anchor" id="ac3c34055be115314ffe7f18c3d19eb54"></a><!-- doxytag: member="qhttpclient.c::head" ref="ac3c34055be115314ffe7f18c3d19eb54" args="(qhttpclient_t *client, const char *uri, int *rescode, qlisttbl_t *reqheaders, qlisttbl_t *resheaders)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool head </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>rescode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>reqheaders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>resheaders</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#ac3c34055be115314ffe7f18c3d19eb54" title="qhttpclient-&gt;head(): Sends a HEAD request.">head()</a>: Sends a HEAD request. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uri</em>&nbsp;</td><td>URL encoded remote URI for downloading file. ("/path" or "http://.../path") </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rescode</em>&nbsp;</td><td>if not NULL, remote response code will be stored. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqheaders</em>&nbsp;</td><td>qlisttbl_t pointer which contains additional user request headers. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>resheaders</em>&nbsp;</td><td>qlisttbl_t pointer for storing response headers. (can be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if successful(got 200 response), otherwise returns false</dd></dl>
<div class="fragment"><pre class="fragment">   main() {
     <span class="comment">// create new HTTP client</span>
     qhttpclient_t *httpclient = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;http://www.qdecoder.org&quot;</span>, 0);
     <span class="keywordflow">if</span>(httpclient == NULL) <span class="keywordflow">return</span>;

     <span class="comment">// set additional custom headers</span>
     qlisttbl_t *reqheaders = qlisttbl();
     qlisttbl_t *resheaders = qlisttbl();

     <span class="comment">// send HEAD request</span>
     <span class="keywordtype">int</span> nRescode = 0;
     <span class="keywordtype">char</span> *pszEncPath = qEncodeUrl(<span class="stringliteral">&quot;/img/qdecoder.png&quot;</span>);
     <span class="keywordtype">bool</span> bRet = httpclient-&gt;head(httpclient, pszEncPath, &amp;nRescode,
                                 reqheaders, resheaders);
     free(pszEncPath);

     <span class="comment">// to print out request, response headers</span>
     reqheaders-&gt;debug(reqheaders, stdout);
     resheaders-&gt;debug(resheaders, stdout);

     <span class="comment">// check results</span>
     <span class="keywordflow">if</span>(bRet == <span class="keyword">false</span>) {
       ...(error occured)...
     }

     <span class="comment">// free resources</span>
     httpclient-&gt;free(httpclient);
     reqheaders-&gt;free(reqheaders);
     resheaders-&gt;free(resheaders);
   }
</pre></div> 
</div>
</div>
<a class="anchor" id="af16a3eb0912e8b5d4896466632d9c843"></a><!-- doxytag: member="qhttpclient.c::get" ref="af16a3eb0912e8b5d4896466632d9c843" args="(qhttpclient_t *client, const char *uri, int fd, off_t *savesize, int *rescode, qlisttbl_t *reqheaders, qlisttbl_t *resheaders, bool(*callback)(void *userdata, off_t recvbytes), void *userdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool get </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t *&nbsp;</td>
          <td class="paramname"> <em>savesize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>rescode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>reqheaders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>resheaders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool(*)(void *userdata, off_t recvbytes)&nbsp;</td>
          <td class="paramname"> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>userdata</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#af16a3eb0912e8b5d4896466632d9c843" title="qhttpclient-&gt;get(): Downloads a file from the remote host using GET method.">get()</a>: Downloads a file from the remote host using GET method. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uri</em>&nbsp;</td><td>URL encoded remote URI for downloading file. ("/path" or "http://.../path") </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>opened file descriptor for writing. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>savesize</em>&nbsp;</td><td>if not NULL, the length of stored bytes will be stored. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rescode</em>&nbsp;</td><td>if not NULL, remote response code will be stored. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqheaders</em>&nbsp;</td><td>qlisttbl_t pointer which contains additional user request headers. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>resheaders</em>&nbsp;</td><td>qlisttbl_t pointer for storing response headers. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>set user call-back function. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>userdata</em>&nbsp;</td><td>set user data for call-back. (can be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if successful(200 OK), otherwise returns false</dd></dl>
<div class="fragment"><pre class="fragment">   <span class="keyword">struct </span>userdata {
     ...
   };

   <span class="keyword">static</span> <span class="keywordtype">bool</span> callback(<span class="keywordtype">void</span> *userdata, off_t sentbytes) {
     <span class="keyword">struct </span>userdata *pMydata = (<span class="keyword">struct </span>userdata*)userdata;
     ...(codes)...
     <span class="keywordflow">if</span>(need_to_cancel) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// stop file uploading immediately</span>
     <span class="keywordflow">return</span> <span class="keyword">true</span>;
   }

   main() {
     <span class="comment">// create new HTTP client</span>
     qhttpclient_t *httpclient = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;http://www.qdecoder.org&quot;</span>, 0);
     <span class="keywordflow">if</span>(httpclient == NULL) <span class="keywordflow">return</span>;

     <span class="comment">// open file</span>
     <span class="keywordtype">int</span> nFd = open(<span class="stringliteral">&quot;/tmp/test.data&quot;</span>, O_WRONLY | O_CREAT, 0644);

     <span class="comment">// set additional custom headers</span>
     qlisttbl_t *reqheaders = qlisttbl();
     qlisttbl_t *resheaders = qlisttbl();

     <span class="comment">// set userdata</span>
     <span class="keyword">struct </span>userdata mydata;
     ...(codes)...

     <span class="comment">// send file</span>
     <span class="keywordtype">int</span> nRescode = 0;
     off_t nSavesize = 0;
     <span class="keywordtype">char</span> *pszEncPath = qEncodeUrl(<span class="stringliteral">&quot;/img/qdecoder.png&quot;</span>);
     <span class="keywordtype">bool</span> bRet = httpclient-&gt;get(httpclient, pszEncPath, nFd, &amp;nSavesize,
                                 &amp;nRescode,
                                 reqheaders, resheaders,
                                 callback, (<span class="keywordtype">void</span>*)&amp;mydata);
     free(pszEncPath);

     <span class="comment">// to print out request, response headers</span>
     reqheaders-&gt;debug(reqheaders, stdout);
     resheaders-&gt;debug(resheaders, stdout);

     <span class="comment">// check results</span>
     <span class="keywordflow">if</span>(bRet == <span class="keyword">false</span>) {
       ...(error occured)...
     }

     <span class="comment">// free resources</span>
     httpclient-&gt;free(httpclient);
     reqheaders-&gt;free(reqheaders);
     resheaders-&gt;free(resheaders);
     close(nFd);
   }
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>The call-back function will be called peridically whenever it send data as much as MAX_ATOMIC_DATA_SIZE. To stop uploading, return false in the call-back function, then PUT process will be stopped immediately. If a connection was not opened, it will open a connection automatically.</dd>
<dd>
The "rescode" will be set if it received any response code from a remote server even though it returns false. </dd></dl>

</div>
</div>
<a class="anchor" id="ae9ac3bd43c11509c0cbd8fb284bf13eb"></a><!-- doxytag: member="qhttpclient.c::put" ref="ae9ac3bd43c11509c0cbd8fb284bf13eb" args="(qhttpclient_t *client, const char *uri, int fd, off_t length, int *rescode, qlisttbl_t *reqheaders, qlisttbl_t *resheaders, bool(*callback)(void *userdata, off_t sentbytes), void *userdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool put </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>rescode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>reqheaders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>resheaders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool(*)(void *userdata, off_t sentbytes)&nbsp;</td>
          <td class="paramname"> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>userdata</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#ae9ac3bd43c11509c0cbd8fb284bf13eb" title="qhttpclient-&gt;put(): Uploads a file to the remote host using PUT method.">put()</a>: Uploads a file to the remote host using PUT method. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uri</em>&nbsp;</td><td>remote URL for uploading file. ("/path" or "http://.../path") </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>opened file descriptor for reading. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>send size. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rescode</em>&nbsp;</td><td>if not NULL, remote response code will be stored. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqheaders</em>&nbsp;</td><td>qlisttbl_t pointer which contains additional user request headers. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>resheaders</em>&nbsp;</td><td>qlisttbl_t pointer for storing response headers. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>set user call-back function. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>userdata</em>&nbsp;</td><td>set user data for call-back. (can be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if successful(201 Created), otherwise returns false</dd></dl>
<div class="fragment"><pre class="fragment">   <span class="keyword">struct </span>userdata {
     ...
   };

   <span class="keyword">static</span> <span class="keywordtype">bool</span> callback(<span class="keywordtype">void</span> *userdata, off_t sentbytes) {
     <span class="keyword">struct </span>userdata *pMydata = (<span class="keyword">struct </span>userdata*)userdata;
     ...(codes)...
     <span class="keywordflow">if</span>(need_to_cancel) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// stop file uploading immediately</span>
     <span class="keywordflow">return</span> <span class="keyword">true</span>;
   }

   main() {
     <span class="comment">// create new HTTP client</span>
     qhttpclient_t *httpclient = <a class="code" href="qhttpclient_8c.html#acba5e1d5c9b1666945f7b0ca4da0785b" title="Initialize &amp;amp; create new HTTP client.">qhttpclient</a>(<span class="stringliteral">&quot;http://www.qdecoder.org&quot;</span>, 0);
     <span class="keywordflow">if</span>(httpclient == NULL) <span class="keywordflow">return</span>;

     <span class="comment">// open file</span>
     <span class="keywordtype">int</span> nFd = open(...);
     off_t nFileSize = ...;
     <span class="keywordtype">char</span> *pFileMd5sum = ...;
     time_t nFileDate = ...;

     <span class="comment">// set additional custom headers</span>
     qlisttbl_t *reqheaders = qlisttbl();
     reqheaders-&gt;putstr(reqheaders, <span class="stringliteral">&quot;X-FILE-MD5SUM&quot;</span>, pFileMd5sum, <span class="keyword">true</span>);
     reqheaders-&gt;putInt(reqheaders, <span class="stringliteral">&quot;X-FILE-DATE&quot;</span>, nFileDate, <span class="keyword">true</span>);

     <span class="comment">// set userdata</span>
     <span class="keyword">struct </span>userdata mydata;
     ...(codes)...

     <span class="comment">// send file</span>
     <span class="keywordtype">int</span> nRescode = 0;
     qlisttbl_t *resheaders = qlisttbl();
     <span class="keywordtype">bool</span> bRet = httpclient-&gt;put(httpclient,
                                 <span class="stringliteral">&quot;/img/qdecoder.png&quot;</span>, nFd, nFileSize,
                                 &amp;nRescode,
                                 reqheaders, resheaders,
                                 callback, (<span class="keywordtype">void</span>*)&amp;mydata);
     <span class="comment">// to print out request, response headers</span>
     reqheaders-&gt;debug(reqheaders, stdout);
     resheaders-&gt;debug(resheaders, stdout);

     <span class="comment">// check results</span>
     <span class="keywordflow">if</span>(bRet == <span class="keyword">false</span>) {
       ...(error occured)...
     }

     <span class="comment">// free resources</span>
     httpclient-&gt;free(httpclient);
     reqheaders-&gt;free(reqheaders);
     resheaders-&gt;free(resheaders);
     close(nFd);
   }
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>The call-back function will be called peridically whenever it send data as much as MAX_ATOMIC_DATA_SIZE. To stop uploading, return false in the call-back function, then PUT process will be stopped immediately. If a connection was not opened, it will open a connection automatically.</dd>
<dd>
The "rescode" will be set if it received any response code from a remote server even though it returns false. </dd></dl>

</div>
</div>
<a class="anchor" id="af152fd3b6a32a801dc70a03119b13154"></a><!-- doxytag: member="qhttpclient.c::cmd" ref="af152fd3b6a32a801dc70a03119b13154" args="(qhttpclient_t *client, const char *method, const char *uri, void *data, size_t size, int *rescode, size_t *contentslength, qlisttbl_t *reqheaders, qlisttbl_t *resheaders)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void* cmd </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>rescode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>contentslength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>reqheaders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>resheaders</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#af152fd3b6a32a801dc70a03119b13154" title="qhttpclient-&gt;cmd(): Sends a custom request(method) to the remote host and reads it&#39;s response...">cmd()</a>: Sends a custom request(method) to the remote host and reads it's response. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>method</em>&nbsp;</td><td>method name. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uri</em>&nbsp;</td><td>remote URL for uploading file. ("/path" or "http://.../path") </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to send. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>data size. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rescode</em>&nbsp;</td><td>if not NULL, remote response code will be stored. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentslength</em>&nbsp;</td><td>if not NULL, the contents length will be stored. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqheaders</em>&nbsp;</td><td>qlisttbl_t pointer which contains additional user request headers. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>resheaders</em>&nbsp;</td><td>qlisttbl_t pointer for storing response headers. (can be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>malloced content data if successful, otherwise returns NULL</dd></dl>
<div class="fragment"><pre class="fragment">   <span class="keywordtype">int</span> nResCode;
   <span class="keywordtype">size_t</span> nContentsLength;
   <span class="keywordtype">void</span> *contents = httpclient-&gt;cmd(httpclient, <span class="stringliteral">&quot;DELETE&quot;</span> <span class="stringliteral">&quot;/img/qdecoder.png&quot;</span>,
                                    NULL, 0
                                    &amp;nRescode, &amp;nContentsLength
                                    NULL, NULL);
   <span class="keywordflow">if</span>(contents == NULL) {
     ...(error occured)...
   } <span class="keywordflow">else</span> {
     printf(<span class="stringliteral">&quot;Response code : %d\n&quot;</span>, nResCode);
     printf(<span class="stringliteral">&quot;Contents length : %zu\n&quot;</span>, nContentsLength);
     printf(<span class="stringliteral">&quot;Contents : %s\n&quot;</span>, (<span class="keywordtype">char</span>*)contents);  <span class="comment">// if contents is printable</span>
     free(contents);  <span class="comment">// de-allocate</span>
   }
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>This store server's response into memory so if you expect server responses large amount of data, consider to use <a class="el" href="qhttpclient_8c.html#a1d31e08f7bc114b63cd3140f5f8dc259" title="qhttpclient-&gt;sendrequest(): Sends a HTTP request to the remote host.">sendrequest()</a> and <a class="el" href="qhttpclient_8c.html#a865df9ac070a17d0751e1083af770bb1" title="qhttpclient-&gt;readresponse(): Reads HTTP response header from the remote host.">readresponse()</a> instead of using this. The returning malloced content will be allocated +1 byte than actual content size 'contentslength' and will be null terminated. </dd></dl>

</div>
</div>
<a class="anchor" id="a1d31e08f7bc114b63cd3140f5f8dc259"></a><!-- doxytag: member="qhttpclient.c::sendrequest" ref="a1d31e08f7bc114b63cd3140f5f8dc259" args="(qhttpclient_t *client, const char *method, const char *uri, qlisttbl_t *reqheaders)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool sendrequest </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>reqheaders</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a1d31e08f7bc114b63cd3140f5f8dc259" title="qhttpclient-&gt;sendrequest(): Sends a HTTP request to the remote host.">sendrequest()</a>: Sends a HTTP request to the remote host. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>method</em>&nbsp;</td><td>HTTP method name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uri</em>&nbsp;</td><td>URI string for the method. ("/path" or "http://.../path") </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reqheaders</em>&nbsp;</td><td>qlisttbl_t pointer which contains additional user request headers. (can be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if successful, otherwise returns false</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Default headers(Host, User-Agent, Connection) will be used if reqheaders does not have those headers in it.</dd></dl>
<div class="fragment"><pre class="fragment">   qlisttbl_t *reqheaders = qlisttbl();
   reqheaders-&gt;putstr(reqheaders,  <span class="stringliteral">&quot;Date&quot;</span>, qTimeGetGmtStaticStr(0), <span class="keyword">true</span>);

   httpclient-&gt;sendrequest(client,
                           <span class="stringliteral">&quot;DELETE&quot;</span>, <span class="stringliteral">&quot;/img/qdecoder.png&quot;</span>, reqheaders);
</pre></div> 
</div>
</div>
<a class="anchor" id="a865df9ac070a17d0751e1083af770bb1"></a><!-- doxytag: member="qhttpclient.c::readresponse" ref="a865df9ac070a17d0751e1083af770bb1" args="(qhttpclient_t *client, qlisttbl_t *resheaders, off_t *contentlength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int readresponse </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qlisttbl_t *&nbsp;</td>
          <td class="paramname"> <em>resheaders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t *&nbsp;</td>
          <td class="paramname"> <em>contentlength</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a865df9ac070a17d0751e1083af770bb1" title="qhttpclient-&gt;readresponse(): Reads HTTP response header from the remote host.">readresponse()</a>: Reads HTTP response header from the remote host. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>resheaders</em>&nbsp;</td><td>qlisttbl_t pointer for storing response headers. (can be NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contentlength</em>&nbsp;</td><td>length of content body(or -1 for chunked transfer encoding) will be stored. (can be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>numeric HTTP response code if successful, otherwise returns 0.</dd></dl>
<div class="fragment"><pre class="fragment">   <span class="comment">// send request</span>
   httpclient-&gt;sendrequest(client, <span class="stringliteral">&quot;DELETE&quot;</span>, <span class="stringliteral">&quot;/img/qdecoder.png&quot;</span>, NULL);

   <span class="comment">// read response</span>
   qlisttbl_t *resheaders = qlisttbl();
   off_t clength;
   <span class="keywordtype">int</span> rescode = httpclient-&gt;readresponse(client, resheaders, &amp;clength);
   <span class="keywordflow">if</span>(clength &gt; 0) {
     <span class="comment">// read &amp; throw out a content. don&#39;t need content</span>
     httpclient-&gt;read(client, NULL, clength);
   }
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>Data of content body must be read by a application side, if you want to use Keep-Alive session. Please refer qhttpclient-&gt;read(). </dd></dl>

</div>
</div>
<a class="anchor" id="ade555b391a0ff83b074eb16a5ba2192f"></a><!-- doxytag: member="qhttpclient.c::gets_" ref="ade555b391a0ff83b074eb16a5ba2192f" args="(qhttpclient_t *client, char *buf, size_t bufsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ssize_t gets_ </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>bufsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;gets(): Reads a text line from a HTTP/HTTPS stream. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>data buffer pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bufsize</em>&nbsp;</td><td>buffer size</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes read from file descriptor if successful, otherwise returns -1.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Be sure the return value does not mean the length of actual stored data. It means how many bytes are readed from the file descriptor, so the new-line characters will be counted, but not be stored. </dd></dl>

</div>
</div>
<a class="anchor" id="a5dd8f813968295a3cfba53c0acaee487"></a><!-- doxytag: member="qhttpclient.c::read_" ref="a5dd8f813968295a3cfba53c0acaee487" args="(qhttpclient_t *client, void *buf, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ssize_t read_ </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;read(): Reads data from a HTTP/HTTPS stream. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>a buffer pointer for storing content. (can be NULL, then read &amp; throw out content) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>content size to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of bytes readed</dd></dl>
<div class="fragment"><pre class="fragment">   off_t clength = 0;
   <span class="keywordtype">int</span> resno = client-&gt;readresponse(client, NULL, &amp;clength);
   <span class="keywordflow">if</span>(clength &gt; 0) {
     <span class="keywordtype">void</span> *buf = malloc(clength);
     client-&gt;read(client, buf, clength);
   }
</pre></div> 
</div>
</div>
<a class="anchor" id="a69254acf43767884d060506b96f5c274"></a><!-- doxytag: member="qhttpclient.c::write_" ref="a69254acf43767884d060506b96f5c274" args="(qhttpclient_t *client, const void *buf, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ssize_t write_ </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;write(): Writes data to a HTTP/HTTPS stream. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>a data pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>content size to write.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of bytes written. </dd></dl>

</div>
</div>
<a class="anchor" id="a2036374892fed2d1eff6eee25dcbfd9b"></a><!-- doxytag: member="qhttpclient.c::recvfile" ref="a2036374892fed2d1eff6eee25dcbfd9b" args="(qhttpclient_t *client, int fd, off_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static off_t recvfile </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;<a class="el" href="qhttpclient_8c.html#a2036374892fed2d1eff6eee25dcbfd9b" title="qhttpclient-&gt;recvfile(): Reads data from a HTTP/HTTPS stream and save into a file descriptor...">recvfile()</a>: Reads data from a HTTP/HTTPS stream and save into a file descriptor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>output file descriptor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nbytes</em>&nbsp;</td><td>the number of bytes to read and save.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes written if successful, otherwise returns -1. </dd></dl>

</div>
</div>
<a class="anchor" id="add20b33d4c87e18756f7023bbc38f22e"></a><!-- doxytag: member="qhttpclient.c::sendfile_" ref="add20b33d4c87e18756f7023bbc38f22e" args="(qhttpclient_t *client, int fd, off_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static off_t sendfile_ </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;sendfile(): Send file data to a HTTP/HTTPS stream. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>qhttpclient object pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>input file descriptor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nbytes</em>&nbsp;</td><td>the number of bytes to read and send.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes sent if successful, otherwise returns -1. </dd></dl>

</div>
</div>
<a class="anchor" id="a6154b9124c5a57bccfb2dc47c791e555"></a><!-- doxytag: member="qhttpclient.c::_close" ref="a6154b9124c5a57bccfb2dc47c791e555" args="(qhttpclient_t *client)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool _close </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;close(): Closes the connection. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>qhttpclient_t</em>&nbsp;</td><td>HTTP object pointer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if successful, otherwise returns false</dd></dl>
<div class="fragment"><pre class="fragment">   httpclient-&gt;close(httpclient);
</pre></div> 
</div>
</div>
<a class="anchor" id="a7a0cda760109d998ee40b94b665ef0ca"></a><!-- doxytag: member="qhttpclient.c::_free" ref="a7a0cda760109d998ee40b94b665ef0ca" args="(qhttpclient_t *client)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void _free </td>
          <td>(</td>
          <td class="paramtype">qhttpclient_t *&nbsp;</td>
          <td class="paramname"> <em>client</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>qhttpclient-&gt;free(): Free object. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>qhttpclient_t</em>&nbsp;</td><td>HTTP object pointer</td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>If the connection was not closed, it will close the connection first prior to de-allocate object.</dd></dl>
<div class="fragment"><pre class="fragment">   httpclient-&gt;free(httpclient);
</pre></div> 
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
<a href="http://www.qdecoder.org/">The qDecoder Project</a>.
Tue Jun 12 2012 07:35:13
</small></address>
</body>
</html>
